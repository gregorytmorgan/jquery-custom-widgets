<!DOCTYPE html>
<!--
JQuery Custom Widget Tests
-->
<html>
  <head>
    <title>JQuery Custom Widget Tests</title>
    <link rel="icon" href="favicon.ico" sizes="16x16 32x32 48x48 64x64 96x96 128x128" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="index.css">
    <script src=" https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="timeline.1.js"></script>
    <script>

      /*
       * On load handler
       *
       * @returns {undefined}
       */
      window.onload = function () {
        console.log("OnLoad");
      };

      /*
       * Document ready handler
       *
       * @type type
       */
      $(document).ready(function () {
        console.log("documentReady");

        // alternate widget initialization syntax
        // var bar = $.custom.progressbar({}, $("<div></div>").appendTo("body"));

        // create the dom element that is the root of the widget. Could just use the
        // container itself?
      //        let tlElement = $("<div></div>");
      //
      //        // construct a timeline widget in the container2 element. We pass
      //        // in two custom handlers for the atstart' and 'atend' custom events
      //        tlElement.appendTo("#container2").timeline({
      //          // override the widgets default initial value.
      //          value: 20,
      //
      //          // override the widgets default handler for the custom atstart event
      //          atstart: function (event, data) {
      //            console.log('Custom event atStart handler defined at initialization.');
      //          }
      //        });


        let con = $("#container2");
        con.timeline({
          // override the widgets default initial value.
          value: 20,

          // override the widgets default handler for the custom atstart event
          atstart: function (event, data) {
            console.log('Custom event atStart handler defined at initialization.');
          }
        });

return;

        // Hack way to call method, by calling object and passing in func name
        console.log("Initial value: " + tlElement.timeline("value"));

        // Alternate way of calling widget methods
        let myTimeline = tlElement.data("custom-timeline");
        myTimeline.value(25);
        console.log("Set the value to 25. Value: " + myTimeline.value());

        // Notes:
        // 1) custom handlers are called before the default.
        // 2) Returning false or using stopImmediatePropagation(), stopPropagation()
        // and preventDefault() does not seem to stop the default handler from firing?
        // 3) Note the closure. the hander doesn't have a widget context?
        tlElement.bind("timelinechange", function (event, data) {
          console.log("Custom change handler. Value is " + data.value);

          if (data.value === 0) {
            myTimeline._trigger("atstart", null, {value: 0});
          } else if (data.value === 100) {
            myTimeline._trigger("atend", null, {value: 100});
          }
        });

        myTimeline.value(0);
        console.log("Set the value to 0. Value: " + myTimeline.value());

        myTimeline.value(100);
        console.log("Set the value to 100. Value: " + myTimeline.value());
      });

  </script>




  </head>
  <body>
    <div id="content">
      <div class="title-block">
        <h1>jQuery Custom Widget Tests</h1>
      </div>

      <div id="container1" class="container half">
        <div class="container-label">
          Container #1
        </div>
      </div>

      <div id="container2" class="container half">
        <div class="container-label">
          Container #2
        </div>
      </div>

    </div> <!-- content -->
  </body>
</html>
